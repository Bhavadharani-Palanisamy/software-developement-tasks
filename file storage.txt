#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_TASKS 100
#define MAX_LEN 100
#define FILENAME "tasks.txt"

char tasks[MAX_TASKS][MAX_LEN];
int count = 0;

void loadTasks() {
    FILE *file = fopen(FILENAME, "r");
    if (file == NULL) return;

    while (fgets(tasks[count], MAX_LEN, file)) {
        tasks[count][strcspn(tasks[count], "\n")] = '\0'; // Remove newline
        count++;
    }
    fclose(file);
}

void saveTasks() {
    FILE *file = fopen(FILENAME, "w");
    for (int i = 0; i < count; i++) {
        fprintf(file, "%s\n", tasks[i]);
    }
    fclose(file);
}

void addTask() {
    if (count >= MAX_TASKS) {
        printf("Task list is full!\n");
        return;
    }
    printf("Enter new task: ");
    getchar(); // Clear newline from previous input
    fgets(tasks[count], MAX_LEN, stdin);
    tasks[count][strcspn(tasks[count], "\n")] = '\0';
    count++;
    saveTasks();
}

void viewTasks() {
    printf("\nYour Tasks:\n");
    for (int i = 0; i < count; i++) {
        printf("%d. %s\n", i + 1, tasks[i]);
    }
}

int main() {
    int choice;
    loadTasks();

    while (1) {
        printf("\nTask Manager\n1. View Tasks\n2. Add Task\n3. Exit\nChoose: ");
        scanf("%d", &choice);

        if (choice == 1) viewTasks();
        else if (choice == 2) addTask();
        else if (choice == 3) break;
        else printf("Invalid choice!\n");
    }

    return 0;
}
